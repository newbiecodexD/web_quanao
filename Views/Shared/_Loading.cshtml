<div id="global-loader" style="position:fixed;inset:0;background:rgba(255,255,255,.85);z-index:9999;display:none;align-items:center;justify-content:center;">
  <div class="text-center">
    <div class="spinner-border text-danger" role="status" style="width:3rem;height:3rem"></div>
    <div class="mt-3 fw-semibold">Vui lòng đợi trong giây lát…</div>
  </div>
</div>
<script>
(function(){
  var loader=document.getElementById('global-loader');
  function show(){ if(loader) loader.style.display='flex'; }
  function hide(){ if(loader) loader.style.display='none'; }
  function delayed(fromEl){
    show();
    var ms = 1000; // mặc định 1s
    if(fromEl){
      var v = parseInt(fromEl.getAttribute('data-loading-ms')); if(!isNaN(v) && v>0) ms = v;
    }
    setTimeout(hide, ms);
  }
  window.AppLoader={ show:show, hide:hide, delayed:delayed };
  document.addEventListener('DOMContentLoaded', function(){
    // initial load
    show(); setTimeout(hide, 600);
    document.body.addEventListener('click', function(e){
      var t=e.target; if(!t) return;
      var el = t.closest('[data-loading]') || t.closest('.js-fetch');
      if(el){ delayed(el); }
    });
    document.body.addEventListener('submit', function(e){
      if(e.target && e.target.classList.contains('js-submit')){ delayed(e.target); }
    });
  });
})();
</script>