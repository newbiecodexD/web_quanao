@model web_quanao.Models.Product
@{
    ViewBag.Title = Model?.Name ?? "Chi ti?t s?n ph?m";
    Layout = "~/Views/Shared/_LayoutHome.cshtml";
}

@section Styles{
    <style>
        .product-gallery img{ max-width:100%; height:auto; display:block; border-radius:6px; }
        .thumbs img{ width:64px; height:64px; object-fit:cover; border-radius:4px; cursor:pointer; }
    </style>
}

<div class="container py-4">
    <div class="row g-4">
        <div class="col-md-6">
            <div class="product-gallery">
                @{ var mainImg = Model?.ProductImages?.OrderByDescending(i=>i.IsPrimary).ThenBy(i=>i.ImageId).FirstOrDefault()?.ImageUrl; }
                <img id="mainImage" src="@Url.Content(mainImg ?? "~/Content/Images/noimage.png")" alt="@Model.Name" />
                @if (Model?.ProductImages != null && Model.ProductImages.Any()){
                    <div class="mt-3 d-flex gap-2 thumbs">
                        @foreach (var img in Model.ProductImages){
                            <img src="@Url.Content(img.ImageUrl)" alt="thumb" data-src="@Url.Content(img.ImageUrl)" />
                        }
                    </div>
                }
            </div>
        </div>
        <div class="col-md-6">
            <h1 class="h3">@Model.Name</h1>
            <div class="text-muted">Danh m?c: @Model.Category?.Name</div>
            <div class="h4 mt-2">@Model.Price.ToString("N0")?</div>
            <p class="mt-3">@Model.Description</p>
            <div class="mt-3">
                @if (Model.ProductSizes != null && Model.ProductSizes.Any()){
                    <label class="form-label">Kích c?</label>
                    <div class="d-flex flex-wrap gap-2">
                        @foreach (var s in Model.ProductSizes.Select(ps=>ps.Size)){
                            <span class="badge bg-light text-dark border">@s.SizeName</span>
                        }
                    </div>
                }
            </div>
            <div class="mt-4">
                <button class="btn btn-dark add-to-cart" data-productid="@Model.ProductId" data-name="@Model.Name" data-price="@Model.Price">Thêm vào gi? hàng</button>
            </div>
        </div>
    </div>
</div>

@section Scripts{
<script>
(function(){
    $(document).on('click', '.thumbs img', function(){
        var src = $(this).data('src');
        if(src){ $('#mainImage').attr('src', src); }
    });
})();
</script>
}
